---
name: acc-find-exception-issues
description: –û–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏—Å–∫–ª—é—á–µ–Ω–∏–π –≤ PHP-–∫–æ–¥–µ. –ù–∞—Ö–æ–¥–∏—Ç –ø—Ä–æ–≥–ª–æ—á–µ–Ω–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è, –æ–±—â–∏–µ catches, –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –∏—Å–∫–ª—é—á–µ–Ω–∏–π, –ø–æ–≤—Ç–æ—Ä–Ω—ã–π throw –±–µ–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞, –∏—Å–∫–ª—é—á–µ–Ω–∏—è –≤ finally.
---

# –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º —Å –∏—Å–∫–ª—é—á–µ–Ω–∏—è–º–∏

–ê–Ω–∞–ª–∏–∑ PHP-–∫–æ–¥–∞ –Ω–∞ –ø—Ä–æ–±–ª–µ–º—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏—Å–∫–ª—é—á–µ–Ω–∏–π.

## –ü–∞—Ç—Ç–µ—Ä–Ω—ã –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è

### 1. –ü—Ä–æ–≥–ª–æ—á–µ–Ω–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è (–ø—É—Å—Ç–æ–π catch)

```php
// –ë–ê–ì: –ò—Å–∫–ª—é—á–µ–Ω–∏–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è
try {
    $this->riskyOperation();
} catch (Exception $e) {
    // –ü—É—Å—Ç–æ–π –±–ª–æ–∫ catch ‚Äî –±–∞–≥ —Å–∫—Ä—ã—Ç
}

// –ë–ê–ì: –¢–æ–ª—å–∫–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, –±–µ–∑ –æ–±—Ä–∞–±–æ—Ç–∫–∏
try {
    $this->process();
} catch (Exception $e) {
    $this->logger->error($e->getMessage());
    // –ù–µ—Ç re-throw, –Ω–µ—Ç return, –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è
}
```

### 2. –û–±—â–∏–π –ø–µ—Ä–µ—Ö–≤–∞—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–π

```php
// –ë–ê–ì: –ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –≤—Å—ë
try {
    $this->save();
} catch (Exception $e) {
    // –ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç TypeError, LogicException –∏ —Ç.–¥.
}

// –ë–ê–ì: –ù–µ–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Throwable
try {
    $this->process();
} catch (Throwable $t) {
    // –ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç Error —Ç–æ–∂–µ, —Å–∫—Ä—ã–≤–∞—è —Ñ–∞—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã
}
```

### 3. –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π

```php
// –ë–ê–ì: –ù–µ–ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–π –≤–Ω–µ—à–Ω–∏–π –≤—ã–∑–æ–≤
$response = $httpClient->request('GET', $url); // –ú–æ–∂–µ—Ç –≤—ã–±—Ä–æ—Å–∏—Ç—å –∏—Å–∫–ª—é—á–µ–Ω–∏–µ

// –ë–ê–ì: –§–∞–π–ª–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –±–µ–∑ try
$content = file_get_contents($path); // –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç false –ø—Ä–∏ –æ—à–∏–±–∫–µ

// –ë–ê–ì: JSON –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—à–∏–±–æ–∫
$data = json_decode($json); // –ú–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å null –ø—Ä–∏ –æ—à–∏–±–∫–µ
```

### 4. –ü–æ–≤—Ç–æ—Ä–Ω—ã–π throw –±–µ–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

```php
// –ë–ê–ì: –ü–æ—Ç–µ—Ä—è–Ω –∫–æ–Ω—Ç–µ–∫—Å—Ç
try {
    $this->process();
} catch (DatabaseException $e) {
    throw new RuntimeException('Failed'); // –ü–æ—Ç–µ—Ä—è–Ω–æ –∏—Å—Ö–æ–¥–Ω–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ
}

// –ò–°–ü–†–ê–í–õ–ï–ù–û: –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ü–µ–ø–æ—á–∫—É
throw new RuntimeException('Failed to process', 0, $e);
```

### 5. –ò—Å–∫–ª—é—á–µ–Ω–∏–µ –≤ –±–ª–æ–∫–µ finally

```php
// –ë–ê–ì: –ò—Å–∫–ª—é—á–µ–Ω–∏–µ –≤ finally —Å–∫—Ä—ã–≤–∞–µ—Ç –∏—Å—Ö–æ–¥–Ω–æ–µ
try {
    $this->process();
} finally {
    $this->cleanup(); // –ï—Å–ª–∏ —ç—Ç–æ –≤—ã–±—Ä–æ—Å–∏—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ, –∏—Å—Ö–æ–¥–Ω–æ–µ –±—É–¥–µ—Ç –ø–æ—Ç–µ—Ä—è–Ω–æ
}

// –ò–°–ü–†–ê–í–õ–ï–ù–û:
} finally {
    try {
        $this->cleanup();
    } catch (Exception $e) {
        $this->logger->warning('Cleanup failed', ['exception' => $e]);
    }
}
```

### 6. –ü—Ä–æ–±–ª–µ–º—ã –ø–æ—Ä—è–¥–∫–∞ catch

```php
// –ë–ê–ì: –†–æ–¥–∏—Ç–µ–ª—å –ø–µ—Ä–µ–¥ –ø–æ—Ç–æ–º–∫–æ–º
try {
    $this->process();
} catch (Exception $e) {
    // –ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –≤—Å—ë
} catch (InvalidArgumentException $e) {
    // –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è
}
```

### 7. Return –≤ finally

```php
// –ë–ê–ì: Return –≤ finally –ø–æ–¥–∞–≤–ª—è–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ
try {
    throw new Exception('Error');
} finally {
    return true; // –ò—Å–∫–ª—é—á–µ–Ω–∏–µ –ø–æ–¥–∞–≤–ª–µ–Ω–æ
}
```

### 8. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–π –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ—Ç–æ–∫–æ–º

```php
// –ë–ê–ì: –ò—Å–∫–ª—é—á–µ–Ω–∏–µ –∫–∞–∫ goto
try {
    foreach ($items as $item) {
        if ($found) {
            throw new FoundException($item);
        }
    }
} catch (FoundException $e) {
    $result = $e->getItem();
}
```

### 9. –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è @throws

```php
// –ë–ê–ì: –ù–µ–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ
public function process(): void
{
    if (!$valid) {
        throw new InvalidArgumentException(); // –ù–µ –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ
    }
}
```

## –ü–∞—Ç—Ç–µ—Ä–Ω—ã Grep

```bash
# –ü—É—Å—Ç—ã–µ –±–ª–æ–∫–∏ catch
Grep: "catch\s*\([^)]+\)\s*\{\s*\}" --glob "**/*.php"

# –û–±—â–∏–π –ø–µ—Ä–µ—Ö–≤–∞—Ç Exception
Grep: "catch\s*\(\s*(Exception|\\\\Exception)\s+" --glob "**/*.php"

# –ü–µ—Ä–µ—Ö–≤–∞—Ç Throwable
Grep: "catch\s*\(\s*(Throwable|\\\\Throwable)\s+" --glob "**/*.php"

# throw new –±–µ–∑ previous
Grep: "throw new \w+Exception\([^,)]+\);" --glob "**/*.php"

# Return –≤ finally
Grep: "finally\s*\{[^}]*return" --glob "**/*.php"
```

## –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Å–µ—Ä—å–µ–∑–Ω–æ—Å—Ç–∏

| –ü–∞—Ç—Ç–µ—Ä–Ω | –°–µ—Ä—å–µ–∑–Ω–æ—Å—Ç—å |
|---------|----------|
| –ü—Ä–æ–≥–ª–æ—á–µ–Ω–Ω–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ | üî¥ –ö—Ä–∏—Ç–∏—á–Ω–æ |
| Return –≤ finally | üî¥ –ö—Ä–∏—Ç–∏—á–Ω–æ |
| –û–±—â–∏–π –ø–µ—Ä–µ—Ö–≤–∞—Ç Throwable | üü† –í–∞–∂–Ω–æ |
| –ü–æ—Ç–µ—Ä—è–Ω–Ω–∞—è —Ü–µ–ø–æ—á–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π | üü† –í–∞–∂–Ω–æ |
| –ò—Å–∫–ª—é—á–µ–Ω–∏—è –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ—Ç–æ–∫–æ–º | üü° –ù–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ |
| –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ @throws | üü° –ù–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ |

## –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

### –°–ø–µ—Ü–∏—Ñ–∏—á–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π

```php
try {
    $this->save();
} catch (UniqueConstraintException $e) {
    throw new DuplicateEmailException($email, 0, $e);
} catch (ConnectionException $e) {
    throw new DatabaseUnavailableException(0, $e);
}
// –û—Å—Ç–∞–ª—å–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è –≤—ã—à–µ
```

### –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ü–µ–ø–æ—á–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π

```php
throw new DomainException(
    sprintf('Failed to process order %s', $orderId),
    previous: $originalException
);
```

### –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π finally

```php
try {
    $this->process();
} finally {
    try {
        $this->cleanup();
    } catch (Throwable $e) {
        // –õ–æ–≥–∏—Ä—É–µ–º, –Ω–æ –Ω–µ –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ–º
        $this->logger->error('Cleanup failed', ['exception' => $e]);
    }
}
```

## –§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞

```markdown
### –ü—Ä–æ–±–ª–µ–º–∞ —Å –∏—Å–∫–ª—é—á–µ–Ω–∏—è–º–∏: [–û–ø–∏—Å–∞–Ω–∏–µ]

**–°–µ—Ä—å–µ–∑–Ω–æ—Å—Ç—å:** üî¥/üü†/üü°
**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `file.php:line`
**–¢–∏–ø:** [Swallowed|Generic Catch|Missing Chain|...]

**–ü—Ä–æ–±–ª–µ–º–∞:**
[–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏—Å–∫–ª—é—á–µ–Ω–∏–π]

**–ö–æ–¥:**
```php
// –ü—Ä–æ–±–ª–µ–º–Ω—ã–π –∫–æ–¥
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
```php
// –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π
```
```
